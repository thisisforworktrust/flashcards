<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hiragana Trainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  font-family:Arial, sans-serif;
  background:#f0f0f0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
  margin:0;
}
select, button{
  padding:10px;
  font-size:1em;
  margin:5px;
}
.flashcard{
  width:300px;
  height:400px;
  perspective:1000px;
  margin-bottom:20px;
  position:relative;
}
.flashcard-inner{
  width:100%;
  height:100%;
  background:white;
  border-radius:15px;
  box-shadow:0 6px 12px rgba(0,0,0,.2);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:5em;
  cursor:pointer;
  transition:.6s;
  transform-style:preserve-3d;
  position:relative;
}
.flipped .flashcard-inner{transform:rotateY(180deg);}
.flashcard-front,.flashcard-back{
  position:absolute;
  width:100%;
  height:100%;
  backface-visibility:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:15px;
  padding:20px;
  box-sizing:border-box;
}
.flashcard-back{
  background:#4CAF50;
  color:white;
  font-size:1.6em;
  transform:rotateY(180deg);
  text-align:center;
}

.match-grid{
  display:none;
  grid-template-columns: repeat(2, 150px);
  gap:10px;
  justify-content:center;
}
.match-item{
  background:white;
  padding:15px;
  font-size:1.2em;
  text-align:center;
  border-radius:10px;
  cursor:pointer;
  user-select:none;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
}
.matched{background:#4CAF50;color:white;}
.hidden{display:none;}
#flashButtons{display:flex; gap:8px; align-items:center;}
</style>
</head>
<body>

<select id="modeSelect" aria-label="Mode">
  <option value="flash">Flashcards</option>
  <option value="match">Matching Mode</option>
</select>

<!-- FLASHCARDS -->
<div class="flashcard" id="card">
  <div class="flashcard-inner">
    <div class="flashcard-front" id="front"></div>
    <div class="flashcard-back" id="back"></div>
  </div>
</div>

<div id="flashButtons">
  <button id="prev" title="Previous">‚¨ÖÔ∏è</button>
  <button id="shuffle" title="Shuffle">üîÄ Shuffle</button>
  <button id="next" title="Next">‚û°Ô∏è</button>
</div>

<!-- MATCHING MODE -->
<div class="match-grid" id="matchGrid" role="grid" aria-label="Matching grid"></div>

<script>
// Full hiragana set with pronunciations in the "romaji (spoken)" format
const hiragana = [
  {char:"„ÅÇ", pron:"a (ah)"},{char:"„ÅÑ", pron:"i (ee)"},{char:"„ÅÜ", pron:"u (oo)"},
  {char:"„Åà", pron:"e (eh)"},{char:"„Åä", pron:"o (oh)"},
  {char:"„Åã", pron:"ka (kah)"},{char:"„Åç", pron:"ki (kee)"},{char:"„Åè", pron:"ku (koo)"},
  {char:"„Åë", pron:"ke (keh)"},{char:"„Åì", pron:"ko (koh)"},
  {char:"„Åï", pron:"sa (sah)"},{char:"„Åó", pron:"shi (shee)"},{char:"„Åô", pron:"su (soo)"},
  {char:"„Åõ", pron:"se (seh)"},{char:"„Åù", pron:"so (soh)"},
  {char:"„Åü", pron:"ta (tah)"},{char:"„Å°", pron:"chi (chee)"},{char:"„Å§", pron:"tsu (tsoo)"},
  {char:"„Å¶", pron:"te (teh)"},{char:"„Å®", pron:"to (toh)"},
  {char:"„Å™", pron:"na (nah)"},{char:"„Å´", pron:"ni (nee)"},{char:"„Å¨", pron:"nu (noo)"},
  {char:"„Å≠", pron:"ne (neh)"},{char:"„ÅÆ", pron:"no (noh)"},
  {char:"„ÅØ", pron:"ha (hah)"},{char:"„Å≤", pron:"hi (hee)"},{char:"„Åµ", pron:"fu (foo)"},
  {char:"„Å∏", pron:"he (heh)"},{char:"„Åª", pron:"ho (hoh)"},
  {char:"„Åæ", pron:"ma (mah)"},{char:"„Åø", pron:"mi (mee)"},{char:"„ÇÄ", pron:"mu (moo)"},
  {char:"„ÇÅ", pron:"me (meh)"},{char:"„ÇÇ", pron:"mo (moh)"},
  {char:"„ÇÑ", pron:"ya (yah)"},{char:"„ÇÜ", pron:"yu (yoo)"},{char:"„Çà", pron:"yo (yoh)"},
  {char:"„Çâ", pron:"ra (rah)"},{char:"„Çä", pron:"ri (ree)"},{char:"„Çã", pron:"ru (roo)"},
  {char:"„Çå", pron:"re (reh)"},{char:"„Çç", pron:"ro (roh)"},
  {char:"„Çè", pron:"wa (wah)"},{char:"„Çí", pron:"wo (o)"},{char:"„Çì", pron:"n (n)"}
];

let index = 0;
const front = document.getElementById('front');
const back = document.getElementById('back');
const card = document.getElementById('card');

function showCard(i){
  front.textContent = hiragana[i].char;
  back.textContent = hiragana[i].pron;
  card.classList.remove('flipped');
}
function nextCard(){
  index = (index + 1) % hiragana.length;
  showCard(index);
}
function prevCard(){
  index = (index - 1 + hiragana.length) % hiragana.length;
  showCard(index);
}
function shuffleCards(){
  for (let i = hiragana.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [hiragana[i], hiragana[j]] = [hiragana[j], hiragana[i]];
  }
  index = 0;
  showCard(index);
}

document.getElementById('next').addEventListener('click', nextCard);
document.getElementById('prev').addEventListener('click', prevCard);
document.getElementById('shuffle').addEventListener('click', shuffleCards);
card.addEventListener('click', () => card.classList.toggle('flipped'));
document.addEventListener('keydown', e => {
  if(e.key === "ArrowRight") nextCard();
  if(e.key === "ArrowLeft") prevCard();
  if(e.key === " ") card.classList.toggle('flipped');
});
showCard(index);

// --- Matching mode ---
const grid = document.getElementById('matchGrid');
let selected = null;
let matches = 0;

function loadMatch(){
  grid.innerHTML = "";
  selected = null;
  matches = 0;

  // pick 4 unique random items from hiragana
  const pool = [...hiragana].sort(()=>Math.random()-0.5).slice(0,4);

  // build card objects: one side is char, the other is pron (full string like "su (soo)")
  const cards = [];
  pool.forEach(p => {
    cards.push({label: p.char, id: p.pron});
    cards.push({label: p.pron, id: p.pron});
  });

  // shuffle and render (2 columns)
  cards.sort(()=>Math.random()-0.5);
  grid.style.display = "grid";
  cards.forEach(c => {
    const div = document.createElement('div');
    div.className = "match-item";
    div.textContent = c.label;
    div.dataset.id = c.id; // matches by id (pron string)
    div.tabIndex = 0;
    div.addEventListener('click', () => handleMatch(div));
    div.addEventListener('keydown', (e) => { if(e.key === 'Enter') handleMatch(div); });
    grid.appendChild(div);
  });
}

function handleMatch(div){
  if(div.classList.contains('matched')) return;
  if(!selected){
    selected = div;
    div.style.background = "#ddd";
  } else {
    // if same element clicked twice, reset
    if(selected === div){
      div.style.background = "";
      selected = null;
      return;
    }
    if(selected.dataset.id === div.dataset.id){
      // correct match: mark both
      selected.classList.add('matched');
      div.classList.add('matched');
      selected.style.background = "";
      matches++;
      // every pair matched increments matches by 1 (we picked 4 pairs => when matches==4 set new set)
      if(matches === 4){
        // small delay so user sees the last match
        setTimeout(loadMatch, 700);
      }
    } else {
      // wrong: flash and reset
      const prev = selected;
      prev.style.background = "";
      selected = null;
    }
    selected = null;
  }
}

// Mode switching
const modeSelect = document.getElementById('modeSelect');
modeSelect.onchange = () => {
  if(modeSelect.value === "match"){
    card.style.display = "none";
    document.getElementById('flashButtons').style.display = "none";
    grid.style.display = "grid";
    loadMatch();
  } else {
    grid.style.display = "none";
    card.style.display = "block";
    document.getElementById('flashButtons').style.display = "flex";
    showCard(index);
  }
};
</script>
</body>
</html>
